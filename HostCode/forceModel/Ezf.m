function y=Ezf(x,y,z,d)
y=(-1/2).*pi.^(-1).*(((-2).*d+4.*y).*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2)).^( ...
  -1)+(-2).*(d+2.*y).*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-1)+x.*(d+(-2).*y).* ...
  (x.^2+z.^2).^(-1).*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2)).^(-1).*(d.^2+(-4).* ...
  d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+2.* ...
  z.^2))+x.*(d+2.*y).*(x.^2+z.^2).^(-1).*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^( ...
  -1).*(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2).*(d.^2+4.*d.*y+4.*(x.^2+ ...
  y.^2+2.*z.^2)));
