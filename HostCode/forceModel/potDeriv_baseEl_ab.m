function [ phi, Ex, Ey, Ez, Psixx, Psixy, Psixz, Psiyy, Psiyz, Psizz ] = potDeriv_baseEl_ab( x_el, y_el, z_el )

phi     = 0 ;
Ex      = 0 ;
Ey      = 0 ;
Ez      = 0 ;
Psixx   = 0 ;
Psixy   = 0 ;
Psixz   = 0 ;
Psiyy   = 0 ;
Psiyz   = 0 ;
Psizz   = 0 ;

a = [0.17085589111184;0.159430457039006;0.103698822318765;0.0786649226234773;0.0595485428423376;0.0584822518412492;0.0631496109296414;0.0719777663342492;0.110103759311239;0.124087975648196];
b = [1.07665878791643;1.24810401255122;1.44491014565381;1.70480215059619;1.91782224818094;2.07785046161065;2.26622039595283;2.46774228797269;2.68178041561257;2.91999997038365];


for i = 1:numel(a)
  x = x_el-(b(i)-1)*25e-6;
  y = y_el;
  z = z_el;
  d = b(i)*50e-6;

  phi = phi + a(i) * ((1/2).*pi.^(-1).*(atan(((1/2).*d+(-1).*y).*z.^(-1))+atan(((1/2).*d+y).* ...
    z.^(-1))+atan(x.*((-1/2).*d+y).*z.^(-1).*(x.^2+((-1/2).*d+y).^2+z.^2).^( ...
    -1/2))+(-1).*atan(x.*((1/2).*d+y).*z.^(-1).*(x.^2+((1/2).*d+y).^2+z.^2) ...
    .^(-1/2))));

  Ex = Ex + a(i) * ((1/2).*pi.^(-1).*z.*(x.^2+z.^2).^(-1).*(2.*y.*((-1).*(d.^2+(-4).*d.*y+ ...
    4.*(x.^2+y.^2+z.^2)).^(-1/2)+(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2)) ...
    +d.*((d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2)+(d.^2+4.*d.*y+4.*( ...
    x.^2+y.^2+z.^2)).^(-1/2))));

  Ey = Ey + a(i) * ((-1/2).*pi.^(-1).*((-4).*z.*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2)).^(-1)+4.* ...
    z.*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-1)+8.*x.*z.*(d.^2+(-4).*d.*y+4.*( ...
    y.^2+z.^2)).^(-1).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2)+(-8).* ...
    x.*z.*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-1).*(d.^2+4.*d.*y+4.*(x.^2+y.^2+ ...
    z.^2)).^(-1/2)));

  Ez = Ez + a(i) * ((-1/2).*pi.^(-1).*(((-2).*d+4.*y).*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2)).^( ...
    -1)+(-2).*(d+2.*y).*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-1)+x.*(d+(-2).*y).* ...
    (x.^2+z.^2).^(-1).*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2)).^(-1).*(d.^2+(-4).* ...
    d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+2.* ...
    z.^2))+x.*(d+2.*y).*(x.^2+z.^2).^(-1).*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^( ...
    -1).*(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2).*(d.^2+4.*d.*y+4.*(x.^2+ ...
    y.^2+2.*z.^2))));

  Psixx = Psixx + a(i) * ((1/2).*pi.^(-1).*z.*(x.^2+z.^2).^(-1).*(8.*x.*y.*((d.^2+(-4).*d.*y+4.*( ...
    x.^2+y.^2+z.^2)).^(-3/2)+(-1).*(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^( ...
    -3/2))+d.*((-4).*x.*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^(-3/2)+(-4).* ...
    x.*(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-3/2)))+(-1).*pi.^(-1).*x.*z.*( ...
    x.^2+z.^2).^(-2).*(2.*y.*((-1).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^( ...
    -1/2)+(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2))+d.*((d.^2+(-4).*d.*y+ ...
    4.*(x.^2+y.^2+z.^2)).^(-1/2)+(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2)) ...
    ));

  Psixy = Psixy + a(i) * ((1/2).*pi.^(-1).*z.*(x.^2+z.^2).^(-1).*(d.*(2.*(d+(-2).*y).*(d.^2+(-4).* ...
    d.*y+4.*(x.^2+y.^2+z.^2)).^(-3/2)+(-2).*(d+2.*y).*(d.^2+4.*d.*y+4.*( ...
    x.^2+y.^2+z.^2)).^(-3/2))+2.*y.*(((-2).*d+4.*y).*(d.^2+(-4).*d.*y+4.*( ...
    x.^2+y.^2+z.^2)).^(-3/2)+(-2).*(d+2.*y).*(d.^2+4.*d.*y+4.*(x.^2+y.^2+ ...
    z.^2)).^(-3/2))+2.*((-1).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2)+ ...
    (d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2))));

  Psixz = Psixz + a(i) * ((1/2).*pi.^(-1).*z.*(x.^2+z.^2).^(-1).*(8.*y.*z.*((d.^2+(-4).*d.*y+4.*( ...
    x.^2+y.^2+z.^2)).^(-3/2)+(-1).*(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^( ...
    -3/2))+d.*((-4).*z.*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^(-3/2)+(-4).* ...
    z.*(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-3/2)))+(-1).*pi.^(-1).*z.^2.*( ...
    x.^2+z.^2).^(-2).*(2.*y.*((-1).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^( ...
    -1/2)+(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2))+d.*((d.^2+(-4).*d.*y+ ...
    4.*(x.^2+y.^2+z.^2)).^(-1/2)+(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2)) ...
    )+(1/2).*pi.^(-1).*(x.^2+z.^2).^(-1).*(2.*y.*((-1).*(d.^2+(-4).*d.*y+4.* ...
    (x.^2+y.^2+z.^2)).^(-1/2)+(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2))+ ...
    d.*((d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2)+(d.^2+4.*d.*y+4.*( ...
    x.^2+y.^2+z.^2)).^(-1/2))));

  Psiyy = Psiyy + a(i) * ((-1/2).*pi.^(-1).*(4.*((-4).*d+8.*y).*z.*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2) ...
    ).^(-2)+(-16).*(d+2.*y).*z.*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-2)+16.*x.*( ...
    d+(-2).*y).*z.*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2)).^(-1).*(d.^2+(-4).*d.*y+ ...
    4.*(x.^2+y.^2+z.^2)).^(-3/2)+32.*x.*(d+(-2).*y).*z.*(d.^2+(-4).*d.*y+4.* ...
    (y.^2+z.^2)).^(-2).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2)+16.* ...
    x.*(d+2.*y).*z.*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-1).*(d.^2+4.*d.*y+4.*( ...
    x.^2+y.^2+z.^2)).^(-3/2)+32.*x.*(d+2.*y).*z.*(d.^2+4.*d.*y+4.*(y.^2+ ...
    z.^2)).^(-2).*(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2)));

  Psiyz = Psiyz + a(i) * ((-1/2).*pi.^(-1).*((-4).*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2)).^(-1)+4.*( ...
    d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-1)+8.*x.*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2) ...
    ).^(-1).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2)+(-8).*x.*(d.^2+ ...
    4.*d.*y+4.*(y.^2+z.^2)).^(-1).*(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^( ...
    -1/2)+32.*z.^2.*((d.^2+(-4).*d.*y+4.*(y.^2+z.^2)).^(-2)+(-1).*(d.^2+4.* ...
    d.*y+4.*(y.^2+z.^2)).^(-2)+x.*((-1).*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2)).^( ...
    -1).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^(-3/2)+(-2).*(d.^2+(-4).*d.* ...
    y+4.*(y.^2+z.^2)).^(-2).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2)+( ...
    d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-1).*(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)) ...
    .^(-3/2)+2.*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-2).*(d.^2+4.*d.*y+4.*(x.^2+ ...
    y.^2+z.^2)).^(-1/2)))));

  Psizz = Psizz + a(i) * ((-1/2).*pi.^(-1).*(16.*(d+(-2).*y).*z.*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2)) ...
    .^(-2)+16.*(d+2.*y).*z.*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-2)+16.*x.*(d+( ...
    -2).*y).*z.*(x.^2+z.^2).^(-1).*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2)).^(-1).*( ...
    d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2)+16.*x.*(d+2.*y).*z.*(x.^2+ ...
    z.^2).^(-1).*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-1).*(d.^2+4.*d.*y+4.*( ...
    x.^2+y.^2+z.^2)).^(-1/2)+(-4).*x.*(d+(-2).*y).*z.*(x.^2+z.^2).^(-1).*( ...
    d.^2+(-4).*d.*y+4.*(y.^2+z.^2)).^(-1).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+ ...
    z.^2)).^(-3/2).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+2.*z.^2))+(-8).*x.*(d+( ...
    -2).*y).*z.*(x.^2+z.^2).^(-1).*(d.^2+(-4).*d.*y+4.*(y.^2+z.^2)).^(-2).*( ...
    d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2).*(d.^2+(-4).*d.*y+4.*(x.^2+ ...
    y.^2+2.*z.^2))+(-2).*x.*(d+(-2).*y).*z.*(x.^2+z.^2).^(-2).*(d.^2+(-4).* ...
    d.*y+4.*(y.^2+z.^2)).^(-1).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+z.^2)).^( ...
    -1/2).*(d.^2+(-4).*d.*y+4.*(x.^2+y.^2+2.*z.^2))+(-4).*x.*(d+2.*y).*z.*( ...
    x.^2+z.^2).^(-1).*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-1).*(d.^2+4.*d.*y+4.* ...
    (x.^2+y.^2+z.^2)).^(-3/2).*(d.^2+4.*d.*y+4.*(x.^2+y.^2+2.*z.^2))+(-8).* ...
    x.*(d+2.*y).*z.*(x.^2+z.^2).^(-1).*(d.^2+4.*d.*y+4.*(y.^2+z.^2)).^(-2).* ...
    (d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2).*(d.^2+4.*d.*y+4.*(x.^2+y.^2+ ...
    2.*z.^2))+(-2).*x.*(d+2.*y).*z.*(x.^2+z.^2).^(-2).*(d.^2+4.*d.*y+4.*( ...
    y.^2+z.^2)).^(-1).*(d.^2+4.*d.*y+4.*(x.^2+y.^2+z.^2)).^(-1/2).*(d.^2+4.* ...
    d.*y+4.*(x.^2+y.^2+2.*z.^2))));

end

end

