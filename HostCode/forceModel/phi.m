function y=phi(x,y,z,d)
y=(1/2).*pi.^(-1).*(atan(((1/2).*d+(-1).*y).*z.^(-1))+atan(((1/2).*d+y).* ...
  z.^(-1))+atan(x.*((-1/2).*d+y).*z.^(-1).*(x.^2+((-1/2).*d+y).^2+z.^2).^( ...
  -1/2))+(-1).*atan(x.*((1/2).*d+y).*z.^(-1).*(x.^2+((1/2).*d+y).^2+z.^2) ...
  .^(-1/2)));
